<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ìŒì•… ì¥ë¥´ ë¶„ë¥˜</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 40px auto;
        }
        h1 {
            margin-bottom: 20px;
        }
        button {
            margin-top: 10px;
            padding: 8px 16px;
            font-size: 16px;
        }
        .result {
            margin-top: 20px;
            padding: 12px;
            border: 1px solid #ccc;
        }
        .loading {
            color: gray;
        }
    </style>
</head>
<body>

<h1>ğŸµ ìŒì•… ì¥ë¥´ ë¶„ë¥˜</h1>

<input type="file" id="fileInput" accept=".mp3,.wav">
<br>
<button onclick="predict()">ì˜ˆì¸¡í•˜ê¸°</button>

<div id="status" class="loading"></div>
<div id="result" class="result"></div>

<script>
async function predict() {
    const fileInput = document.getElementById("fileInput");
    const status = document.getElementById("status");
    const resultDiv = document.getElementById("result");

    resultDiv.innerHTML = "";
    status.innerText = "";

    if (fileInput.files.length === 0) {
        alert("ì˜¤ë””ì˜¤ íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.");
        return;
    }

    const file = fileInput.files[0];
    const formData = new FormData();
    formData.append("file", file);

    status.innerText = "ì˜ˆì¸¡ ì¤‘ì…ë‹ˆë‹¤...";

    try {
        const response = await fetch("http://127.0.0.1:8000/predict", {
            method: "POST",
            body: formData
        });

        if (!response.ok) {
            throw new Error("ì„œë²„ ì˜¤ë¥˜");
        }

        const data = await response.json();

        status.innerText = "";

        let html = "<h3>ê²°ê³¼</h3><ol>";
        for (const item of data.topk) {
            html += `<li>${item.genre} : ${(item.prob * 100).toFixed(2)}%</li>`;
        }
        html += "</ol>";

        resultDiv.innerHTML = html;

    } catch (err) {
        status.innerText = "";
        resultDiv.innerHTML = `<span style="color:red">ì—ëŸ¬ ë°œìƒ: ${err.message}</span>`;
    }
}
</script>

</body>
</html>